<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="es" xml:lang="es" xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="stylesheet" type="text/css" href="base.css" />
<link rel="stylesheet" type="text/css" href="content.css" />
<link rel="stylesheet" type="text/css" href="nav.css" />
<meta http-equiv="content-type" content="text/html;  charset=utf-8" />
<title>Ejercicio </title>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<meta http-equiv="content-language" content="es" />
<meta name="generator" content="eXeLearning 2.0.1 - exelearning.net" />
<script type="text/javascript" src="exe_jquery.js"></script>
<script type="text/javascript">$exe_i18n={show:"Mostrar",hide:"Ocultar",showFeedback:"Mostrar retroalimentación",hideFeedback:"Ocultar retroalimentación",correct:"Correcto",incorrect:"Incorrecto",menu:"Menú"}</script>
<script type="text/javascript" src="common.js"></script>
</head>
<body class="exe-web-site"><script type="text/javascript">document.body.className+=" js"</script>
<div id="content">
<p id="skipNav"><a href="#main" class="sr-av">Saltar la navegación</a></p>
<div id="emptyHeader"></div>
<div id="siteNav">
<ul>
   <li><a href="index.html" class="daddy main-node">PIG</a></li>
   <li><a href="introduccin.html" class="no-ch">Introducción</a></li>
   <li><a href="instalacin.html" class="no-ch">Instalación</a></li>
   <li><a href="grunt_shell.html" class="daddy">Grunt Shell</a>
   <ul class="other-section">
      <li><a href="pigbootup.html" class="no-ch">.pigbootup</a></li>
      <li><a href="acceso_a_hdfs.html" class="no-ch">Acceso a HDFS</a></li>
      <li><a href="otros_comandos.html" class="no-ch">Otros comandos</a></li>
   </ul>
   </li>
   <li><a href="log4j.html" class="no-ch">log4j</a></li>
   <li><a href="introduccin_a_pig_latin.html" class="daddy">Introducción a Pig Latin</a>
   <ul class="other-section">
      <li><a href="tipos_de_datos.html" class="no-ch">Tipos de datos</a></li>
      <li><a href="operadores.html" class="no-ch">Operadores</a></li>
      <li><a href="operadores_relacionales.html" class="daddy">Operadores relacionales</a>
      <ul class="other-section">
         <li><a href="cross.html" class="no-ch">CROSS</a></li>
         <li><a href="distinct.html" class="no-ch">DISTINCT</a></li>
         <li><a href="filter.html" class="no-ch">FILTER</a></li>
         <li><a href="foreach.html" class="no-ch">FOREACH</a></li>
         <li><a href="group.html" class="no-ch">GROUP</a></li>
         <li><a href="join.html" class="no-ch">JOIN</a></li>
         <li><a href="limit.html" class="no-ch">LIMIT</a></li>
         <li><a href="load.html" class="no-ch">LOAD</a></li>
         <li><a href="order_by.html" class="no-ch">ORDER BY</a></li>
         <li><a href="sample.html" class="no-ch">SAMPLE</a></li>
         <li><a href="split.html" class="no-ch">SPLIT</a></li>
         <li><a href="store.html" class="no-ch">STORE</a></li>
         <li><a href="stream.html" class="no-ch">STREAM</a></li>
         <li><a href="union.html" class="no-ch">UNION</a></li>
      </ul>
      </li>
   </ul>
   </li>
   <li><a href="udf_user_defined_functions.html" class="daddy">UDF (user defined functions)</a>
   <ul class="other-section">
      <li><a href="ejemplo_de_udf.html" class="no-ch">Ejemplo de UDF</a></li>
   </ul>
   </li>
   <li><a href="pig_latin_avanzado.html" class="no-ch">Pig Latin Avanzado</a></li>
   <li><a href="ejemplo.html" class="no-ch">Ejemplo</a></li>
   <li id="active"><a href="ejercicio.html" class="active no-ch">Ejercicio</a></li>
</ul>
</div>
<div id='topPagination'>
<div class="pagination noprt">
<a href="ejemplo.html" class="prev"><span>&laquo; </span>Anterior</a>
</div>
</div>
<div id="main-wrapper">
<div id="main"><a name="main"></a>
<div id="nodeDecoration"><h1 id="nodeTitle">Ejercicio</h1></div>
<div class="iDevice_wrapper FreeTextIdevice" id="id57">
<div class="iDevice emphasis0">
<div id="ta57_85" class="block iDevice_content">
<p>Partiendo de la discografía de Pink Floyd (año, nombre disco, ranking EEUU, ranking UK)</p>
<p>1967, The Piper at the Gates of Dawn,131,6 <br />1968, A Saucerful of Secrets,999,9 <br />1969, Music from the Film More,153,9 <br />1969, Ummagumma,74,5 <br />1970, Atom Heart Mother,55,1 <br />1972, Obscured by Clouds, 46,6 <br />1973, The Dark Side of the Moon, 1,1 <br />1975, Wish you Were Here, 1,1 <br />1977, Animals, 3,2 <br />1979, The Wall, 1,3 <br />1983, The Final Cut, 6,1 <br />1987, A Momentary Lapse of Reason,3,3 <br />1994, The Division Bell, 1,1 <br />2014, The Endless River, 3, 1</p>
<p>Indicar los comandos empleados para resolver las siguientes preguntas:</p>
<p>1. Crear un fichero llamado discos.txt</p>
<p>2. Arrancar HDFS, Yarn y el job history</p>
<p>3. <span id="docs-internal-guid-6c42b8a6-260d-ce1f-b19b-7a44a6ade3bf">Subir el fichero a HDFS dentro de la carpeta /ejerciciosPig/discos.txt</span></p>
<p>4. <span id="docs-internal-guid-6c42b8a6-260d-f787-f027-36cf1db9462b">Ejecutar la instrucción ls sobre Hadoop para indicar el tamaño del fichero</span></p>
<p>5. <span id="docs-internal-guid-6c42b8a6-260e-1377-25fc-a595ecfc8d95">Arrancar pig en modo distribuido (si se desea eliminar trazas de log) y ejecutar el siguiente comando: cat hdfs://localhost:9000/ejerciciosPig/discos.txt para confirmar que los primeros puntos han funcionado correctamente y el fichero está subido a HDFS</span></p>
<p>6. <span id="docs-internal-guid-6c42b8a6-260e-3b09-649f-09211748cd35">Cargar el fichero de hdfs en una variable llamada discos</span></p>
<p>7. <span id="docs-internal-guid-6c42b8a6-260e-585f-4f38-ba74f325ffc6">Calcular los discos que no estuvieron en el top 10 en EEUU o UK (indicar también el resultado)</span></p>
<p>8. <span id="docs-internal-guid-6c42b8a6-260f-8a78-cafb-2fe76e9d23af">Obtener la máxima y mínima posición que ocuparon los discos de Pink Floyd en EEUU y en UK (indicar también el resultado)  empleando los comandos de LATIN PIG</span></p>
<p dir="ltr" id="docs-internal-guid-6c42b8a6-260f-b6ae-1e16-c380b79d85c4">9. Realiza el mismo ejercicio que antes empleando las funciones de piggybank <a href="https://pig.apache.org/docs/r0.14.0/api/org/apache/pig/EvalFunc.html">https://pig.apache.org/docs/r0.14.0/api/org/apache/pig/EvalFunc.html</a></p>
<p dir="ltr" id="docs-internal-guid-6c42b8a6-2610-0390-444d-54883c589fdd"><span>10. Explica con tus propias palabras lo que se desea obtener con los siguientes comandos e indica el resultado obtenido.</span></p>
<p dir="ltr"><span>a = foreach discos generate anio;</span></p>
<p dir="ltr"><span>b = distinct a;</span></p>
<p dir="ltr"><span>dump b;</span></p>
<p> </p>
</div>
</div>
</div>
</div>
</div>
<div id='bottomPagination'>
<div class="pagination noprt">
<a href="ejemplo.html" class="prev"><span>&laquo; </span>Anterior</a>
</div>
</div>
</div>
</body></html>