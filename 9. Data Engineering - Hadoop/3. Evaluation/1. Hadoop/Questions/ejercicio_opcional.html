<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="es" xml:lang="es" xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="stylesheet" type="text/css" href="base.css" />
<link rel="stylesheet" type="text/css" href="content.css" />
<link rel="stylesheet" type="text/css" href="nav.css" />
<meta http-equiv="content-type" content="text/html;  charset=utf-8" />
<title>Ejercicio (opcional) </title>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<meta http-equiv="content-language" content="es" />
<meta name="generator" content="eXeLearning 2.0.1 - exelearning.net" />
<script type="text/javascript" src="exe_jquery.js"></script>
<script type="text/javascript">$exe_i18n={show:"Mostrar",hide:"Ocultar",showFeedback:"Mostrar retroalimentación",hideFeedback:"Ocultar retroalimentación",correct:"Correcto",incorrect:"Incorrecto",menu:"Menú"}</script>
<script type="text/javascript" src="common.js"></script>
</head>
<body class="exe-web-site"><script type="text/javascript">document.body.className+=" js"</script>
<div id="content">
<p id="skipNav"><a href="#main" class="sr-av">Saltar la navegación</a></p>
<div id="emptyHeader"></div>
<div id="siteNav">
<ul>
   <li><a href="index.html" class="daddy main-node">Hadoop</a></li>
   <li><a href="conceptos_bsicos_y_definiciones.html" class="daddy">Conceptos básicos y definiciones</a>
   <ul class="other-section">
      <li><a href="conceptos_previos.html" class="no-ch">Conceptos previos</a></li>
      <li><a href="qu_es_apache_hadoop.html" class="no-ch">¿Qué es Apache Hadoop?</a></li>
      <li><a href="ecosistema_hadoop.html" class="no-ch">Ecosistema Hadoop</a></li>
      <li><a href="quin_usa_hadoop.html" class="no-ch">Quién usa Hadoop</a></li>
      <li><a href="mdulos_de_hadoop.html" class="daddy">Módulos de Hadoop</a>
      <ul class="other-section">
         <li><a href="hadoop_common.html" class="no-ch">Hadoop Common</a></li>
         <li><a href="hadoop_distributed_file_system_hdfs.html" class="no-ch">Hadoop Distributed File System (HDFS™)</a></li>
         <li><a href="hadoop_yarn.html" class="no-ch">Hadoop YARN</a></li>
         <li><a href="hadoop_mapreduce.html" class="no-ch">Hadoop MapReduce</a></li>
         <li><a href="programacin_de_trabajos.html" class="no-ch">Programación de trabajos</a></li>
      </ul>
      </li>
      <li><a href="instalacin_de_hadoop.html" class="daddy">Instalación de Hadoop</a>
      <ul class="other-section">
         <li><a href="prerrequisitos.html" class="daddy">Prerrequisitos</a>
         <ul class="other-section">
            <li><a href="descargar_e_instalar_hadoop.html" class="no-ch">Descargar e instalar Hadoop</a></li>
            <li><a href="actualizar_mquina_virtual.html" class="no-ch">Actualizar máquina virtual</a></li>
            <li><a href="confirmar_versin_de_java.html" class="no-ch">Confirmar versión de Java</a></li>
            <li><a href="crear_y_configurar_los_certificados_ssh.html" class="no-ch">Crear y configurar los certificados SSH</a></li>
         </ul>
         </li>
         <li><a href="modificar_ficheros_de_configuracin.html" class="daddy">Modificar ficheros de configuración</a>
         <ul class="other-section">
            <li><a href="bashrc.html" class="no-ch">~/.bashrc</a></li>
            <li><a href="coresitexml.html" class="no-ch">core-site.xml</a></li>
            <li><a href="hadoopenvsh.html" class="no-ch">hadoop-env.sh</a></li>
            <li><a href="hdfssitexml.html" class="no-ch">hdfs-site.xml</a></li>
            <li><a href="mapredsitexml.html" class="no-ch">mapred-site.xml</a></li>
            <li><a href="yarnsitexml.html" class="no-ch">yarn-site.xml</a></li>
         </ul>
         </li>
         <li><a href="formatear_el_sistema_de_archivos_de_hadoop.html" class="no-ch">Formatear el sistema de archivos de Hadoop</a></li>
         <li><a href="demonios.html" class="daddy">Demonios</a>
         <ul class="other-section">
            <li><a href="arrancar_demonios_hdfs.html" class="no-ch">Arrancar demonios HDFS</a></li>
            <li><a href="arrancar_demonios_yarn.html" class="no-ch">Arrancar demonios Yarn</a></li>
            <li><a href="parar_demonios_hdfs.html" class="no-ch">Parar demonios HDFS</a></li>
            <li><a href="parar_demonios_yarn.html" class="no-ch">Parar demonios Yarn</a></li>
            <li><a href="arrancar_demonios_individualmente.html" class="no-ch">Arrancar demonios individualmente</a></li>
         </ul>
         </li>
      </ul>
      </li>
      <li><a href="interfaces_web_de_hadoop.html" class="daddy">Interfaces Web de Hadoop</a>
      <ul class="other-section">
         <li><a href="namenode_web_interface_hdfs_layer.html" class="no-ch">NameNode Web Interface (HDFS layer)</a></li>
         <li><a href="resource_manager_web_interface_yarn_layer.html" class="no-ch">Resource Manager Web Interface (Yarn layer)</a></li>
         <li><a href="map_reduce_jobhistory.html" class="no-ch">Map Reduce JobHistory</a></li>
      </ul>
      </li>
      <li><a href="ejemplo_comprobacin_instalacin.html" class="no-ch">Ejemplo comprobación instalación</a></li>
      <li><a href="ejercicio_comprobacin_instalacin.html" class="no-ch">Ejercicio: comprobación instalación</a></li>
   </ul>
   </li>
   <li><a href="hdfs.html" class="daddy">HDFS</a>
   <ul class="other-section">
      <li><a href="introduccin.html" class="no-ch">Introducción</a></li>
      <li><a href="arquitectura_hdfs.html" class="no-ch">Arquitectura HDFS</a></li>
      <li><a href="replicacin_de_datos.html" class="no-ch">Replicación de datos</a></li>
      <li><a href="el_nodo_secundario.html" class="no-ch">El nodo secundario</a></li>
      <li><a href="arrancar_hadoop.html" class="no-ch">Arrancar Hadoop</a></li>
      <li><a href="comandos_bsicos_de_hdfs.html" class="no-ch">Comandos básicos de HDFS</a></li>
      <li><a href="ejemplo_de_uso_de_comandos_bsicos_hdfs.html" class="no-ch">Ejemplo de uso de comandos básicos HDFS</a></li>
      <li><a href="api_de_programacin_de_hdfs.html" class="no-ch">API de programación de HDFS</a></li>
      <li><a href="ejercicio1.html" class="daddy">EJERCICIO</a>
      <ul class="other-section">
         <li><a href="a_uso_de_hdfs.html" class="no-ch">A. Uso de HDFS</a></li>
         <li><a href="b_map_reduce.html" class="no-ch">B: Map Reduce</a></li>
         <li><a href="ejercicio2.html" class="no-ch">EJERCICIO</a></li>
      </ul>
      </li>
   </ul>
   </li>
   <li class="current-page-parent"><a href="map_reduce.html" class="current-page-parent daddy">Map Reduce</a>
   <ul>
      <li><a href="procesamiento_en_paralelo.html" class="no-ch">Procesamiento en Paralelo</a></li>
      <li><a href="fundamentos.html" class="no-ch">Fundamentos</a></li>
      <li><a href="ejemplo_sencillo_de_map_reduce.html" class="no-ch">Ejemplo sencillo de map Reduce</a></li>
      <li><a href="explicacin_modelo_map_reduce.html" class="no-ch">Explicación modelo Map Reduce</a></li>
      <li><a href="ejemplo.html" class="daddy">Ejemplo</a>
      <ul class="other-section">
         <li><a href="datos_de_entrada.html" class="no-ch">Datos de entrada</a></li>
         <li><a href="1_mapeo.html" class="no-ch">1. Mapeo</a></li>
         <li><a href="2_mezcla.html" class="no-ch">2. Mezcla</a></li>
         <li><a href="3_reduccin.html" class="no-ch">3. Reducción</a></li>
         <li><a href="resultado.html" class="no-ch">Resultado</a></li>
         <li><a href="interfaz_web.html" class="no-ch">Interfaz Web</a></li>
      </ul>
      </li>
      <li><a href="ejercicio_diccionario.html" class="no-ch">Ejercicio: diccionario</a></li>
      <li id="active"><a href="ejercicio_opcional.html" class="active no-ch">Ejercicio (opcional)</a></li>
      <li><a href="ms_ejemplos.html" class="no-ch">Más ejemplos</a></li>
   </ul>
   </li>
</ul>
</div>
<div id='topPagination'>
<div class="pagination noprt">
<a href="ejercicio_diccionario.html" class="prev"><span>&laquo; </span>Anterior</a> | <a href="ms_ejemplos.html" class="next"> Siguiente<span> &raquo;</span></a>
</div>
</div>
<div id="main-wrapper">
<div id="main"><a name="main"></a>
<div id="nodeDecoration"><h1 id="nodeTitle">Ejercicio (opcional)</h1></div>
<div class="iDevice_wrapper FreeTextIdevice" id="id144">
<div class="iDevice emphasis0">
<div id="ta144_1" class="block iDevice_content">
<p><span style="font-family: trebuchet ms,geneva; font-size: small;">Partiendo del siguiente ejemplo que realiza la suma del número de líneas que contienen los ficheros que recibe como entrada, </span></p>
<div><em><span style="font-family: courier new,courier; font-size: small;">import java.io.IOException;</span></em><br /><em><span style="font-family: courier new,courier; font-size: small;">import java.util.*;</span></em><br /><em><span style="font-family: courier new,courier; font-size: small;">import org.apache.hadoop.fs.Path;</span></em><br /><em><span style="font-family: courier new,courier; font-size: small;">import org.apache.hadoop.conf.*;</span></em><br /><em><span style="font-family: courier new,courier; font-size: small;">import org.apache.hadoop.io.*;</span></em><br /><em><span style="font-family: courier new,courier; font-size: small;">import org.apache.hadoop.mapred.*;</span></em><br /><em><span style="font-family: courier new,courier; font-size: small;">import org.apache.hadoop.util.*;</span></em><br /><em><span style="font-family: courier new,courier; font-size: small;">public class LineCount {</span></em><br /><em><span style="font-family: courier new,courier; font-size: small;">        public static class Map extends MapReduceBase implements Mapper&lt;LongWritable, Text, Text, IntWritable&gt; {</span></em><br /><em><span style="font-family: courier new,courier; font-size: small;">                private final static IntWritable uno= new IntWritable(1);</span></em><br /><em><span style="font-family: courier new,courier; font-size: small;">                private Text word = new Text("Total Lineas");</span></em><br /><em><span style="font-family: courier new,courier; font-size: small;">                public void map(LongWritable key, Text value, OutputCollector&lt;Text, IntWritable&gt; output, Reporter reporter) throws IOException {</span></em><br /><em><span style="font-family: courier new,courier; font-size: small;">                        output.collect(word, uno);</span></em><br /><em><span style="font-family: courier new,courier; font-size: small;">                }</span></em><br /><em><span style="font-family: courier new,courier; font-size: small;">   }</span></em><br /><em><span style="font-family: courier new,courier; font-size: small;">   public static class Reduce extends MapReduceBase implements Reducer&lt;Text, IntWritable, Text, IntWritable&gt; {</span></em><br /><em><span style="font-family: courier new,courier; font-size: small;">     public void reduce(Text key, Iterator&lt;IntWritable&gt; values, OutputCollector&lt;Text, IntWritable&gt; output, Reporter reporter) throws IOException {</span></em><br /><em><span style="font-family: courier new,courier; font-size: small;">       int sum = 0;</span></em><br /><em><span style="font-family: courier new,courier; font-size: small;">       while (values.hasNext()) {</span></em><br /><em><span style="font-family: courier new,courier; font-size: small;">         sum += values.next().get();</span></em><br /><em><span style="font-family: courier new,courier; font-size: small;">       }</span></em><br /><em><span style="font-family: courier new,courier; font-size: small;">       output.collect(key, new IntWritable(sum));</span></em><br /><em><span style="font-family: courier new,courier; font-size: small;">     }</span></em><br /><em><span style="font-family: courier new,courier; font-size: small;">   }</span></em><br /><em><span style="font-family: courier new,courier; font-size: small;">   public static void main(String[] args) throws Exception {</span></em><br /><em><span style="font-family: courier new,courier; font-size: small;">     JobConf conf = new JobConf(LineCount.class);</span></em><br /><em><span style="font-family: courier new,courier; font-size: small;">     conf.setJobName("LineCount");</span></em><br /><em><span style="font-family: courier new,courier; font-size: small;">     conf.setOutputKeyClass(Text.class);</span></em><br /><em><span style="font-family: courier new,courier; font-size: small;">     conf.setOutputValueClass(IntWritable.class);</span></em><br /><em><span style="font-family: courier new,courier; font-size: small;">     conf.setMapperClass(Map.class);</span></em><br /><em><span style="font-family: courier new,courier; font-size: small;">     conf.setCombinerClass(Reduce.class);</span></em><br /><em><span style="font-family: courier new,courier; font-size: small;">     conf.setReducerClass(Reduce.class);</span></em><br /><em><span style="font-family: courier new,courier; font-size: small;">     conf.setInputFormat(TextInputFormat.class);</span></em><br /><em><span style="font-family: courier new,courier; font-size: small;">     conf.setOutputFormat(TextOutputFormat.class);</span></em><br /><em><span style="font-family: courier new,courier; font-size: small;">     FileInputFormat.setInputPaths(conf, new Path(args[0]));</span></em><br /><em><span style="font-family: courier new,courier; font-size: small;">     FileOutputFormat.setOutputPath(conf, new Path(args[1]));</span></em><br /><em><span style="font-family: courier new,courier; font-size: small;">     JobClient.runJob(conf);</span></em><br /><em><span style="font-family: courier new,courier; font-size: small;">   }</span></em><br /><em><span style="font-family: courier new,courier; font-size: small;">}</span></em><br />
<div> </div>
<div><span id="docs-internal-guid-dd5e2e58-7809-dbc8-b1c1-cc3cda384ba4"><span><img src="https://lh3.googleusercontent.com/e5IFiLzAETEVXLbsn-SDQa_M0Fs-LvCfxdPgkdwbhHQ-tfK6GCMGjTQq-Hov8Y8Pzv9oYKGCo4hM_D9sjV9IXjN4t_98GQdKmTyTehs7QPmxW9-Rl6j1sLnKVHABf6bbxw" width="487px;" height="23px;" /></span></span></div>
<div> </div>
<div><span id="docs-internal-guid-59b8b72b-7b5c-537c-0079-8cbe4c061fed"><span><img src="https://lh3.googleusercontent.com/0DCDezmCfykh-3ncJCkjGAM2sUcAxx3NkVON2GfVe1uNdHgsLyaHm1OupqQy3tGBisIm65lB3_LulcX4UCUeLplsBVMi4_EtXskjBGHXzpVjEHOA2GYE8zewx9d3Ez6ppg" width="624px;" height="148px;" /></span></span></div>
<div> </div>
<div><span id="docs-internal-guid-59b8b72b-7b5d-bcd8-0a1b-177ded942ec7"><span style="font-size: 0.75em; line-height: 1.5;"> </span><span><img src="https://lh4.googleusercontent.com/ZXpGg7kUSYP2eElSpMYZnRfFB40bX3-Tywg3uLoMtPCuDPhQy3iDsx5RdTOzgJc_PHAkRyH8R3_oPDTka4pKekSH-bSWLVyj1w7gnkBTUEd6JNtaqUrWnpdSSaeBZ8Cn1w" width="624px;" height="133px;" /></span></span></div>
<div><span id="docs-internal-guid-dd5e2e58-7b73-f751-a776-3370cdbc2162"><span><img src="https://lh6.googleusercontent.com/t9MqkFZ-XW8Iy6ZNUvbCdUo8bqyS2O8NhUeLYDSQgf4LgcJ0AI7v-6t_fUAiNqh2Z5ciWuOv8oozDufYpYRztym_3OohiVad-TeVDNqTmalifyCCBb0G4KxwxJfUyT1qcw" width="624px;" height="48px;" /></span></span></div>
<div> </div>
<div><span id="docs-internal-guid-dd5e2e58-7818-782d-6d17-9c64f21c4e33"><span><img src="https://lh5.googleusercontent.com/RAmffVulL8IacO7YKQ7GGxEbtUelsdH6c_JlGkq1hy24hCbcUuHRy_1-OUUaE1cABJ8Fby_TTd2f6_4WHh5GPA4fgyqy_tfKK0GlADrLGF4k_U20skMv5EAVISqGaQ6lDQ" width="610px;" height="37px;" /></span></span></div>
<div><span style="font-size: 0.75em; line-height: 1.5;"> </span></div>
<div><span id="docs-internal-guid-59b8b72b-7b66-7e46-57d1-26fa423336a9"><span><img src="https://lh3.googleusercontent.com/d3C5IAqe7g71Fj9eDZdUG1onRtEqEn1HFqgeSRVfIPvMeqZ6LGOk4vZ5OTYPWCAKZy7bBJaIzL8Wv_mgu-OiP_AaByyjWnLpO9x8cIvki6Lt8PO24KgZldkhda2Umoe-zA" width="624px;" height="295px;" /></span></span></div>
<div> </div>
<div><span><span id="docs-internal-guid-dd5e2e58-7b68-cc0f-b8d2-731ba14dc3fb"><span><img src="https://lh3.googleusercontent.com/JCZJ-_RPmOk3-xrnYeWoksdTGwywo14CmNaFzlYBAXWL5ZJeouM9OdUu8fXWvDYcQJL05fez9YdZiP6lRZ2gumOmb8o-gnkKI9ZQqiRIgKLFCWRAUpFzpBaGlyQ_tlhu9Q" width="624px;" height="133px;" /></span></span></span></div>
<div> </div>
<div><span style="font-family: trebuchet ms,geneva; font-size: small;">Terminar de desarrollar las funciones de mapeo y de reducción para que en el siguiente programa, que recibe como entrada los mismos ficheros del ejemplo anterior, con una palabra por columna, devuelva el número de líneas distintas en el fichero. <span style="line-height: 1.5;"> </span></span></div>
<div> </div>
<span style="font-family: courier new,courier; font-size: small;">import java.io.IOException;</span><br /><span style="font-family: courier new,courier; font-size: small;">import java.util.*;</span><br /><span style="font-family: courier new,courier; font-size: small;">import org.apache.hadoop.fs.Path;</span><br /><span style="font-family: courier new,courier; font-size: small;">import org.apache.hadoop.conf.*;</span><br /><span style="font-family: courier new,courier; font-size: small;">import org.apache.hadoop.io.*;</span><br /><span style="font-family: courier new,courier; font-size: small;">import org.apache.hadoop.mapred.*;</span><br /><span style="font-family: courier new,courier; font-size: small;">import org.apache.hadoop.util.*;</span><br /><span style="font-family: courier new,courier; font-size: small;">public class PalabrasDistintas {</span><br /><span style="font-family: courier new,courier; font-size: small;">        public static class Map extends MapReduceBase implements Mapper&lt;LongWritable,Text,Text,IntWritable&gt; {</span><br /><span style="font-family: courier new,courier; font-size: small;">                private final static IntWritable uno= new IntWritable(1);</span><br /><span style="font-family: courier new,courier; font-size: small;">                private Text palabra= new Text(........);</span><br /><span style="font-family: courier new,courier; font-size: small;">                public void map(LongWritable key, Text value, OutputCollector&lt;Text,IntWritable&gt; output, Reporter reporter) throws IOException {</span><br /><span style="font-family: courier new,courier; font-size: small;">                        ............................;</span><br /><span style="font-family: courier new,courier; font-size: small;">                        ............................;</span><br /><span style="font-family: courier new,courier; font-size: small;">                }</span><br /><span style="font-family: courier new,courier; font-size: small;">        }</span><br /><span style="font-family: courier new,courier; font-size: small;">        public static class Reduce extends MapReduceBase implements Reducer&lt;Text, IntWritable, Text, IntWritable&gt; {</span><br /><span style="font-family: courier new,courier; font-size: small;">                public void reduce(Text key, Iterator&lt;IntWritable&gt; values, OutputCollector&lt;Text, IntWritable&gt; output, Reporter reporter) throws IOException {</span><br /><span style="font-family: courier new,courier; font-size: small;">                        int sum = 0;</span><br /><span style="font-family: courier new,courier; font-size: small;">                        while (values.hasNext()) {</span><br /><span style="font-family: courier new,courier; font-size: small;">                                ...............;</span><br /><span style="font-family: courier new,courier; font-size: small;">                                ...............;</span><br /><span style="font-family: courier new,courier; font-size: small;">                        }</span><br /><span style="font-family: courier new,courier; font-size: small;">                        output.collect(key, new IntWritable(sum));</span><br /><span style="font-family: courier new,courier; font-size: small;">                }</span><br /><span style="font-family: courier new,courier; font-size: small;">        }</span><br /><br /><span style="font-family: courier new,courier; font-size: small;">        public static void main(String[] args) throws Exception {</span><br /><span style="font-family: courier new,courier; font-size: small;">                JobConf conf = new JobConf(PalabrasDistintas.class);</span><br /><span style="font-family: courier new,courier; font-size: small;">                conf.setJobName("Palabras Distintas");</span><br /><span style="font-family: courier new,courier; font-size: small;">                conf.setOutputKeyClass(Text.class);</span><br /><span style="font-family: courier new,courier; font-size: small;">                conf.setOutputValueClass(IntWritable.class);</span><br /><span style="font-family: courier new,courier; font-size: small;">                conf.setMapperClass(Map.class);</span><br /><span style="font-family: courier new,courier; font-size: small;">                conf.setReducerClass(Reduce.class);</span><br /><span style="font-family: courier new,courier; font-size: small;">                conf.setInputFormat(TextInputFormat.class);</span><br /><span style="font-family: courier new,courier; font-size: small;">                conf.setOutputFormat(TextOutputFormat.class);</span><br /><span style="font-family: courier new,courier; font-size: small;">                FileInputFormat.setInputPaths(conf, new Path(args[0]));</span><br /><span style="font-family: courier new,courier; font-size: small;">                FileOutputFormat.setOutputPath(conf, new Path(args[1]));</span><br /><span style="font-family: courier new,courier; font-size: small;">                JobClient.runJob(conf);</span><br /><span style="font-family: courier new,courier; font-size: small;">        }</span><br /><span style="font-family: courier new,courier; font-size: small;">}</span><br /> <br />
<div><span style="font-family: trebuchet ms,geneva; font-size: small;"> </span></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id='bottomPagination'>
<div class="pagination noprt">
<a href="ejercicio_diccionario.html" class="prev"><span>&laquo; </span>Anterior</a> | <a href="ms_ejemplos.html" class="next"> Siguiente<span> &raquo;</span></a>
</div>
</div>
</div>
</body></html>