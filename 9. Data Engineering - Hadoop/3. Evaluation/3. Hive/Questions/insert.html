<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="es" xml:lang="es" xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="stylesheet" type="text/css" href="base.css" />
<link rel="stylesheet" type="text/css" href="content.css" />
<link rel="stylesheet" type="text/css" href="nav.css" />
<meta http-equiv="content-type" content="text/html;  charset=utf-8" />
<title>Insert </title>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<meta http-equiv="content-language" content="es" />
<meta name="generator" content="eXeLearning 2.0.1 - exelearning.net" />
<script type="text/javascript" src="exe_jquery.js"></script>
<script type="text/javascript">$exe_i18n={show:"Mostrar",hide:"Ocultar",showFeedback:"Mostrar retroalimentación",hideFeedback:"Ocultar retroalimentación",correct:"Correcto",incorrect:"Incorrecto",menu:"Menú"}</script>
<script type="text/javascript" src="common.js"></script>
</head>
<body class="exe-web-site"><script type="text/javascript">document.body.className+=" js"</script>
<div id="content">
<p id="skipNav"><a href="#main" class="sr-av">Saltar la navegación</a></p>
<div id="emptyHeader"></div>
<div id="siteNav">
<ul>
   <li><a href="index.html" class="daddy main-node">Hive</a></li>
   <li><a href="caractersticas.html" class="no-ch">Características</a></li>
   <li><a href="instalacin.html" class="daddy">Instalación</a>
   <ul class="other-section">
      <li><a href="comprobar_instalacin.html" class="no-ch">Comprobar instalación</a></li>
   </ul>
   </li>
   <li><a href="tipos_de_datos.html" class="no-ch">Tipos de datos</a></li>
   <li><a href="operadores.html" class="no-ch">Operadores</a></li>
   <li><a href="otros_operadores.html" class="no-ch">Otros operadores</a></li>
   <li><a href="estructuras_de_datos.html" class="daddy">Estructuras de datos</a>
   <ul class="other-section">
      <li><a href="bases_de_datos.html" class="no-ch">Bases de datos</a></li>
      <li><a href="tablas.html" class="no-ch">Tablas</a></li>
      <li><a href="partitioned_tables.html" class="no-ch">Partitioned Tables</a></li>
      <li><a href="external_tables_and_partitioned_tables.html" class="no-ch">External Tables and Partitioned Tables</a></li>
      <li><a href="bucket.html" class="no-ch">Bucket</a></li>
      <li><a href="vistas.html" class="no-ch">Vistas</a></li>
      <li><a href="indices.html" class="no-ch">Indices</a></li>
   </ul>
   </li>
   <li><a href="ejemplo_word_count.html" class="no-ch">Ejemplo: word count</a></li>
   <li><a href="ejercicio_1_tipos_de_datos_simples.html" class="no-ch">Ejercicio 1: tipos de datos simples</a></li>
   <li><a href="ejemplo_estructuras_complejas.html" class="no-ch">Ejemplo: estructuras complejas</a></li>
   <li><a href="ejercicio_2_tipos_de_datos_complejos.html" class="no-ch">Ejercicio 2: tipos de datos complejos</a></li>
   <li><a href="otros_comandos_ddl_data_definition_language.html" class="no-ch">Otros comandos DDL (Data Definition Language)</a></li>
   <li class="current-page-parent"><a href="operaciones_dmldata_manipulation_language.html" class="current-page-parent daddy">Operaciones DML(Data Manipulation Language)</a>
   <ul>
      <li><a href="load.html" class="no-ch">Load</a></li>
      <li id="active"><a href="insert.html" class="active no-ch">Insert</a></li>
      <li><a href="update.html" class="no-ch">Update</a></li>
      <li><a href="delete.html" class="no-ch">Delete</a></li>
      <li><a href="exportimport.html" class="no-ch">Export/Import</a></li>
   </ul>
   </li>
   <li><a href="ejemplo_crear_una_tabla_en_hive_y_cargar_un_origen_de_datos.html" class="no-ch">EJEMPLO: Crear una tabla en Hive y cargar un origen de datos</a></li>
   <li><a href="almacenamiento_de_datos.html" class="daddy">Almacenamiento de datos</a>
   <ul class="other-section">
      <li><a href="almacenamiento_en_ficheros.html" class="no-ch">Almacenamiento en ficheros</a></li>
      <li><a href="almacenamiento_en_registros.html" class="no-ch">Almacenamiento en registros</a></li>
      <li><a href="conversin_del_tipo_de_almacenamiento.html" class="no-ch">Conversión del tipo de almacenamiento</a></li>
      <li><a href="compresin.html" class="no-ch">Compresión</a></li>
   </ul>
   </li>
   <li><a href="introduccin_a_sqoop.html" class="daddy">Introducción a Sqoop</a>
   <ul class="other-section">
      <li><a href="import_creacin_de_conexin.html" class="no-ch">Import: creación de conexión</a></li>
      <li><a href="import_definicin_de_datos_a_migrar.html" class="no-ch">Import: definición de datos a migrar</a></li>
      <li><a href="import_cargar_datos_en_hive_y_hbase.html" class="no-ch">Import: cargar datos en Hive y Hbase</a></li>
      <li><a href="importalltables.html" class="no-ch">Import-all-tables</a></li>
      <li><a href="export.html" class="no-ch">Export</a></li>
   </ul>
   </li>
   <li><a href="ejercicio.html" class="no-ch">Ejercicio</a></li>
</ul>
</div>
<div id='topPagination'>
<div class="pagination noprt">
<a href="load.html" class="prev"><span>&laquo; </span>Anterior</a> | <a href="update.html" class="next"> Siguiente<span> &raquo;</span></a>
</div>
</div>
<div id="main-wrapper">
<div id="main"><a name="main"></a>
<div id="nodeDecoration"><h1 id="nodeTitle">Insert</h1></div>
<div class="iDevice_wrapper FreeTextIdevice" id="id43">
<div class="iDevice emphasis0">
<div id="ta43_85" class="block iDevice_content">
<h3 id="LanguageManualDML-InsertingdataintoHiveTablesfromqueries"><span>Insertar datos en tablas Hive empleando queries</span></h3>
<p><span style="font-size: small; font-family: 'trebuchet ms', geneva;">Los resultados de una query se pueden insertar en tablas empleando esta sentencia. </span></p>
<p><span style="font-size: small; font-family: 'trebuchet ms', geneva;">Sintaxis estándar: </span></p>
<p id="LanguageManualDML-Syntax.1"><span style="font-size: small; font-family: 'trebuchet ms', geneva;">INSERT OVERWRITE TABLE tablename1 [PARTITION (partcol1=val1, partcol2=val2 ...) [IF NOT EXISTS]] select_statement1 FROM from_statement;</span></p>
<p><span style="font-size: small; font-family: 'trebuchet ms', geneva;">Sintaxis extendida (múltiples insert):</span></p>
<p><span style="font-size: small; font-family: 'trebuchet ms', geneva;">FROM from_statement</span><br /><span style="font-size: small; font-family: 'trebuchet ms', geneva;">INSERT OVERWRITE TABLE tablename1 [PARTITION (partcol1=val1, partcol2=val2 ...) [IF NOT EXISTS]] select_statement1</span><br /><span style="font-size: small; font-family: 'trebuchet ms', geneva;">[INSERT OVERWRITE TABLE tablename2 [PARTITION ... [IF NOT EXISTS]] select_statement2]</span><br /><span style="font-size: small; font-family: 'trebuchet ms', geneva;">[INSERT INTO TABLE tablename2 [PARTITION ...] select_statement2] ...;</span></p>
<p><span style="font-size: small; font-family: 'trebuchet ms', geneva;">Inserción de particiones: </span></p>
<p><span style="font-size: small; font-family: 'trebuchet ms', geneva;">INSERT OVERWRITE TABLE tablename PARTITION (partcol1[=val1], partcol2[=val2] ...) select_statement FROM from_statement;</span><br /><span style="font-size: small; font-family: 'trebuchet ms', geneva;">INSERT INTO TABLE tablename PARTITION (partcol1[=val1], partcol2[=val2] ...) select_statement FROM from_statement;</span></p>
<div class="code panel pdl"><span style="font-size: small; font-family: 'trebuchet ms', geneva;">Descripción:  </span></div>
<ul>
<li><span style="font-size: small; font-family: 'trebuchet ms', geneva;">INSERT OVERWRITE sobreescribirá cualquier dato existente en la tabla o partición. </span></li>
<li><span style="font-size: small; font-family: 'trebuchet ms', geneva;">INSERT INTO añadirá a la tabla o partición los datos, manteniendo los datos existentes intactos. </span></li>
<li><span style="font-size: small; font-family: 'trebuchet ms', geneva;">La propiedad immutable permite bloquear escrituras en tablas mediante el comando INSERT INTO. Si permite la inserción con el comando OVERWRITE. Por defecto esta propiedad vale false, pero se puede asignar con el comando <a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-CreateTable">TBLPROPERTIES ("immutable"="true")</a>. </span></li>
<li><span style="font-size: small; font-family: 'trebuchet ms', geneva;">Los inserts pueden realizarse sobre una tabla o una partición. Si la tabla está particionada, debe indicarse la partición de la tabla los valores de las columnas particionadas. </span></li>
<li><span style="font-size: small; font-family: 'trebuchet ms', geneva;">Se pueden realizar multiples inserts en una misma query, minimizando el número de posicionamientos requeridos para insertar los datos. </span></li>
<li><span style="font-size: small; font-family: 'trebuchet ms', geneva;">La salida de cada una de las sentencias es escrita en la tabla o partición elegida. </span></li>
<li><span style="font-size: small; font-family: 'trebuchet ms', geneva;">El formato de salida y la clase de serialización de datos se determina por los metadatos de la tabla (definidos con los comandos DDL)</span></li>
</ul>
<h5 id="LanguageManualDML-DynamicPartitionInserts"><span style="font-size: small; font-family: 'trebuchet ms', geneva;">Insert en particiones dinámicas</span></h5>
<div class="aui-message warning shadowed information-macro">
<p class="title"><span style="font-size: small; font-family: 'trebuchet ms', geneva;">En los inserts en particiones dinámicas, los usuarios pueden indicar parte de las especificaciones de la partición, lo que significa que sólo es necesario especificar los nombres de las columnas en la sentencia partición.Los valores de las columnas son opcionales. Si el valor es indicado, entonces se trata de una partición estática. En caso contrario es una partición dinámica. Cada columna particionada dinámicamente, tiene una columna de entrada correspondiente indicada en la sentencia select. Esto significa que la creación de las particiones dinámicas se determina por el valor de la columna de entrada. Las columnas particionadas dinámicamente, deben especificarse en el mismo orden que aparecen en la partición. </span></p>
<p class="title"><span style="font-size: small; font-family: 'trebuchet ms', geneva;">Por defecto, los inserts en particiones dinámicas están deshabilitados. Estas son las propiedades de configuración más relevantes para las particiones dinámicas.  </span></p>
</div>
<div class="table-wrap">
<table class="confluenceTable tablesorter" border="1">
<thead>
<tr class="sortableHeader"><th class="confluenceTh sortableHeader">
<div class="tablesorter-header-inner">
<p><span>Configuration property</span></p>
</div>
</th><th class="confluenceTh sortableHeader">
<div class="tablesorter-header-inner">
<p><span>Default</span></p>
</div>
</th><th class="confluenceTh sortableHeader">
<div class="tablesorter-header-inner">
<p><span>Note</span></p>
</div>
</th></tr>
</thead>
<tbody>
<tr>
<td class="confluenceTd">
<p><span><code>hive.exec.dynamic.partition</code></span></p>
</td>
<td class="confluenceTd">
<p><span><code>false</code></span></p>
</td>
<td class="confluenceTd">
<p><span>Needs to be set to <code>true</code> to enable dynamic partition inserts</span></p>
</td>
</tr>
<tr>
<td class="confluenceTd">
<p><span><code>hive.exec.dynamic.partition.mode</code></span></p>
</td>
<td class="confluenceTd">
<p><span><code>strict</code></span></p>
</td>
<td class="confluenceTd">
<p><span>In <code>strict</code> mode, the user must specify at least one static partition in case the user accidentally overwrites all partitions, in <code>nonstrict</code> mode all partitions are allowed to be dynamic</span></p>
</td>
</tr>
<tr>
<td class="confluenceTd">
<p><span><code>hive.exec.max.dynamic.partitions.pernode</code></span></p>
</td>
<td class="confluenceTd">
<p><span>100</span></p>
</td>
<td class="confluenceTd">
<p><span>Maximum number of dynamic partitions allowed to be created in each mapper/reducer node</span></p>
</td>
</tr>
<tr>
<td class="confluenceTd">
<p><span><code>hive.exec.max.dynamic.partitions</code></span></p>
</td>
<td class="confluenceTd">
<p><span>1000</span></p>
</td>
<td class="confluenceTd">
<p><span>Maximum number of dynamic partitions allowed to be created in total</span></p>
</td>
</tr>
<tr>
<td class="confluenceTd">
<p><span><code>hive.exec.max.created.files</code></span></p>
</td>
<td class="confluenceTd">
<p><span>100000</span></p>
</td>
<td class="confluenceTd">
<p><span>Maximum number of HDFS files created by all mappers/reducers in a MapReduce job</span></p>
</td>
</tr>
<tr>
<td class="confluenceTd">
<p><span><code>hive.error.on.empty.partition</code></span></p>
</td>
<td class="confluenceTd">
<p><span><code>false</code></span></p>
</td>
<td class="confluenceTd">
<p><span>Whether to throw an exception if dynamic partition insert generates empty results</span></p>
</td>
</tr>
</tbody>
</table>
</div>
<p id="LanguageManualDML-Example"><span style="font-size: small; font-family: 'trebuchet ms', geneva;">Ejemplo </span></p>
<p><span style="font-family: 'trebuchet ms', geneva; font-size: small;">FROM page_view_stg pvs</span><br /><span style="font-family: 'trebuchet ms', geneva; font-size: small;">INSERT OVERWRITE TABLE page_view PARTITION(dt='2014-12-20', comunidad)</span><br /><span style="font-family: 'trebuchet ms', geneva; font-size: small;">SELECT pvs.viewTime, pvs.userid, pvs.page_url, pvs.referrer_url, null, null, pvs.ip, pvs.ccaa </span></p>
<p><span style="font-family: 'trebuchet ms', geneva; font-size: small;">Aquí la partición comunidad será creada dinámicamente por la última columna de la sentencia select (pvs.ccaa). </span></p>
<p id="LanguageManualDML-AdditionalDocumentation"><span style="font-family: 'trebuchet ms', geneva; font-size: small;"><strong>Escribir datos en el sistema de archivos desde queries</strong></span></p>
<p><span style="font-family: 'trebuchet ms', geneva; font-size: small;">Los resultados de las queries también se pueden insertar en el sistema de archivos empleando una sentencia ligeramente distinta a la anterior: </span></p>
<p><span style="font-family: 'trebuchet ms', geneva; font-size: small;">Sintaxis: </span></p>
<p><span style="font-family: 'trebuchet ms', geneva; font-size: small;">Sintaxis estándar:</span><br /><span style="font-family: 'trebuchet ms', geneva; font-size: small;">INSERT OVERWRITE [LOCAL] DIRECTORY directory1</span><br /><span style="font-family: 'trebuchet ms', geneva; font-size: small;">[ROW FORMAT row_format] [STORED AS file_format] </span><br /><span style="font-family: 'trebuchet ms', geneva; font-size: small;">SELECT ... FROM ...</span><br /><br /><span style="font-family: 'trebuchet ms', geneva; font-size: small;">Sintaxis extendida para múltiples inserciones: </span><br /><span style="font-family: 'trebuchet ms', geneva; font-size: small;">FROM from_statement</span><br /><span style="font-family: 'trebuchet ms', geneva; font-size: small;">INSERT OVERWRITE [LOCAL] DIRECTORY directory1 select_statement1</span><br /><span style="font-family: 'trebuchet ms', geneva; font-size: small;">[INSERT OVERWRITE [LOCAL] DIRECTORY directory2 select_statement2] ...</span><br /><br /><span style="font-family: 'trebuchet ms', geneva; font-size: small;">row_format</span><br /><span style="font-family: 'trebuchet ms', geneva; font-size: small;">: DELIMITED [FIELDS TERMINATED BY char [ESCAPED BY char]] [COLLECTION ITEMS TERMINATED BY char]</span><br /><span style="font-family: 'trebuchet ms', geneva; font-size: small;">[MAP KEYS TERMINATED BY char] [LINES TERMINATED BY char]</span><br /><span style="font-family: 'trebuchet ms', geneva; font-size: small;">[NULL DEFINED AS char]</span></p>
<p><span style="font-family: 'trebuchet ms', geneva; font-size: small;">Descripción: </span></p>
<ul>
<li><span style="font-family: 'trebuchet ms', geneva; font-size: small;">Directory puede ser una URI completa. Si el eseuqma o la autorización no se indican, entonces se empleará la configurada por hadoop en la variable fs.default.name que especifica la URI del NameNode. </span></li>
<li><span style="font-family: 'trebuchet ms', geneva; font-size: small;">Si se emplea la palabra LOCAL, Hive escribirá los datos en el directorio perteneciente al sistema de datos local. </span></li>
<li><span style="font-family: 'trebuchet ms', geneva; font-size: small;">Los datos escritos al sistema de archivos son serializados como texto separados por ^A y filas separadas por nuevas líneas. Si alguna de las columnas no es un tipo primitivo, entonces estas columnas son serializadas con el formato JSON. </span></li>
<li><span style="font-family: 'trebuchet ms', geneva; font-size: small;">Las sentencias INSERT OVERWRITE sobre directorios, directorios locales y tablas o particiones, se pueden mezclar en la misma query. </span></li>
<li><span style="font-family: 'trebuchet ms', geneva; font-size: small;">Las sentencias INSERT OVERWRITE sobre directorios del sistema de archivos de HDFS son el mejor modo de extraer grandes cantidades de información de Hive, ya que Hive puede escribir en directorios en paralelo empleando un job de Map-reduce. </span></li>
</ul>
<h3 id="LanguageManualDML-InsertingvaluesintotablesfromSQL"><span style="font-family: 'trebuchet ms', geneva; font-size: small;">Insertar valores en tablas de SQL</span></h3>
<p><span style="font-family: 'trebuchet ms', geneva; font-size: small;">El comando insert también se puede usar para volcar datos a tablas de SQL. </span></p>
<p><span style="font-family: 'trebuchet ms', geneva; font-size: small;">Sintaxis estándar:</span><br /><span style="font-family: 'trebuchet ms', geneva; font-size: small;">INSERT INTO TABLE tablename [PARTITION (partcol1[=val1], partcol2[=val2] ...)] VALUES values_row [, values_row ...]</span><br /><br /><span style="font-family: 'trebuchet ms', geneva; font-size: small;">Donde values_row es: ( value [, value ...] ), donde cada valor es o nulo o cualquier valor válido SQL</span></p>
<p><span style="font-family: 'trebuchet ms', geneva; font-size: small;">Características</span></p>
<ul>
<li><span style="font-family: 'trebuchet ms', geneva; font-size: small;">Cada fila incluida en el listado de VALUES es insertada en la tabla llamada tablename</span></li>
<li><span style="font-family: 'trebuchet ms', geneva; font-size: small;">Los valores deben ser proporcionados para cada columna de la tabla. La sintaxis estándar SQL para permite insertar valores sólo en algunas consultas, todavía no se ha desarrollado, pero sí se permite insertar nulos en las columnas que el usuario no desee asignar valor. </span></li>
<li><span style="font-family: 'trebuchet ms', geneva; font-size: small;">Las particiones dinámicas se gestionan del mismo modo que INSERT .... SELECT</span></li>
</ul>
<h5 id="LanguageManualDML-Examples"><span style="font-family: 'trebuchet ms', geneva; font-size: small;">Ejemplos:  </span></h5>
<p><span style="font-family: 'trebuchet ms', geneva; font-size: small;">CREATE TABLE estudiantes (nombre VARCHAR(64), edad INT, nota DECIMAL(3, 2))</span><br /><span style="font-family: 'trebuchet ms', geneva; font-size: small;">CLUSTERED BY (edad) INTO 2 BUCKETS STORED AS ORC;</span><br /><br /><span style="font-family: 'trebuchet ms', geneva; font-size: small;">INSERT INTO TABLE estudiantes</span><br /><span style="font-family: 'trebuchet ms', geneva; font-size: small;">VALUES ('John Smith', 35, 8.28), ('Jane Brown', 32, 7.32); </span><br /><br /><span style="font-family: 'trebuchet ms', geneva; font-size: small;">CREATE TABLE pageviews (userid VARCHAR(64), link STRING, from STRING)</span><br /><span style="font-family: 'trebuchet ms', geneva; font-size: small;">PARTITIONED BY (datestamp STRING) CLUSTERED BY (userid) INTO 256 BUCKETS STORED AS ORC; </span><br /><br /><span style="font-family: 'trebuchet ms', geneva; font-size: small;">INSERT INTO TABLE pageviews PARTITION (datestamp = '2014-12-23')</span><br /><span style="font-family: 'trebuchet ms', geneva; font-size: small;">VALUES ('jsmith', 'mail.com', 'sports.com'), ('jdoe', 'mail.com', null);</span><br /><br /><span style="font-family: 'trebuchet ms', geneva; font-size: small;">INSERT INTO TABLE pageviews PARTITION (datestamp)</span><br /><span style="font-family: 'trebuchet ms', geneva; font-size: small;">VALUES ('tjohnson', 'sports.com', 'finance.com', '2014-12-23'), ('tlee', 'finance.com', null, '2014-12-21');</span></p>
</div>
</div>
</div>
</div>
</div>
<div id='bottomPagination'>
<div class="pagination noprt">
<a href="load.html" class="prev"><span>&laquo; </span>Anterior</a> | <a href="update.html" class="next"> Siguiente<span> &raquo;</span></a>
</div>
</div>
</div>
</body></html>